FROM python:3.13-slim

ENV PYTHONDONTWRITEBYTECODE=1 \
    PYTHONUNBUFFERED=1

WORKDIR /app

COPY requirements-worker.txt /app/requirements-worker.txt
RUN pip install --no-cache-dir -r /app/requirements-worker.txt

COPY worker /app/worker

CMD ["sh", "-c", "celery -A worker.celery worker -l info -Q ${CELERY_QUEUES:-scenarios} -P ${CELERY_POOL:-solo} --concurrency=${CELERY_CONCURRENCY:-1} -n ${CELERY_NAME:-worker@%h}"]
